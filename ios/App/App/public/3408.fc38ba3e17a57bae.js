"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3408],{3408:(I,P,d)=>{d.r(P),d.d(P,{ProductAddPageModule:()=>y});var p=d(177),i=d(9417),n=d(4742),m=d(9192),h=d(467),g=d(7691),o=d(4438),k=d(636);function F(t,a){if(1&t){const c=o.RV6();o.j41(0,"div",26),o.nrm(1,"img",27),o.j41(2,"ion-button",28),o.bIt("click",function(){o.eBV(c);const r=o.XpG();return o.Njj(r.deleteImage())}),o.nrm(3,"ion-icon",29),o.EFF(4," Eliminar Imagen "),o.k0s()()}if(2&t){const c=o.XpG();o.R7$(),o.Y8G("src",c.productImage,o.B4B)}}function b(t,a){if(1&t){const c=o.RV6();o.j41(0,"ion-item",30)(1,"ion-label",7),o.EFF(2,"Peso"),o.k0s(),o.nrm(3,"ion-input",31),o.j41(4,"ion-label",7),o.EFF(5,"Precio"),o.k0s(),o.nrm(6,"ion-input",32),o.j41(7,"ion-label",7),o.EFF(8,"Stock"),o.k0s(),o.nrm(9,"ion-input",33),o.j41(10,"ion-button",34),o.bIt("click",function(){const r=o.eBV(c).index,l=o.XpG();return o.Njj(l.removeWeightOption(r))}),o.EFF(11,"Eliminar"),o.k0s()()}if(2&t){const c=a.index,e=o.XpG();o.Y8G("formGroup",e.getWeightFormGroup(c))}}const v=[{path:"",component:(()=>{var t;class a{constructor(e,r,l){this.formBuilder=e,this.productService=r,this.router=l,this.productImage=null,this.productForm=this.formBuilder.group({nombre:["",i.k0.required],descripcion:["",i.k0.required],precio:[0,[i.k0.required,i.k0.min(0)]],stock:[0,[i.k0.required,i.k0.min(0)]],categoria:["",i.k0.required],weightOptions:this.formBuilder.array([])}),this.addWeightOption()}get weightOptions(){return this.productForm.get("weightOptions")}getWeightFormGroup(e){return this.weightOptions.at(e)}addWeightOption(){const e=this.formBuilder.group({size:["",i.k0.required],price:[0,[i.k0.required,i.k0.min(0)]],stock:[0,[i.k0.required,i.k0.min(0)]]});this.weightOptions.push(e)}removeWeightOption(e){this.weightOptions.removeAt(e)}selectImage(){var e=this;return(0,h.A)(function*(){try{const r=yield g.i7.getPhoto({quality:90,allowEditing:!1,resultType:g.LK.Uri,source:g.ru.Prompt});e.productImage=r.webPath,console.log("URL de la imagen seleccionada:",e.productImage)}catch(r){console.error("Error al capturar imagen:",r)}})()}deleteImage(){this.productImage=null}generateId(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=16*Math.random()|0;return("x"===e?r:3&r|8).toString(16)})}addProduct(){var e=this;return(0,h.A)(function*(){if(e.productForm.valid){const{weightOptions:r,...l}=e.productForm.value,u={id:e.generateId(),...l,imagen:e.productImage||null,categoria:e.productForm.value.categoria},f=r.map(s=>({...s,id:e.generateId(),producto_id:u.id}));try{yield e.productService.addProductWithWeightsSQLite(u,f),console.log("Producto y opciones de peso a\xf1adidas en SQLite."),(yield e.productService.isApiAvailable())?(yield e.productService.addProductWithWeightsAPI(u,f),console.log("Producto y opciones de peso sincronizadas con \xe9xito en la API."),yield e.productService.deleteProductWithWeightsSQLite(u.id)):console.log("La API no est\xe1 disponible, el producto permanece en SQLite para sincronizar m\xe1s tarde."),e.router.navigate(["/productos/product-list"]),e.resetForm()}catch(s){console.error("Error al agregar el producto y las opciones de peso:",s)}}else console.log("Formulario inv\xe1lido")})()}resetForm(){this.productForm.reset({nombre:"",descripcion:"",precio:0,stock:0,categoria:""}),this.productImage=null,this.weightOptions.clear(),this.addWeightOption()}goToProductAll(){this.router.navigate(["/productos/product-all"])}}return(t=a).\u0275fac=function(e){return new(e||t)(o.rXU(i.ok),o.rXU(k.b),o.rXU(m.Ix))},t.\u0275cmp=o.VBU({type:t,selectors:[["app-product-add"]],decls:51,vars:4,consts:[["color","primary"],["slot","end"],[3,"click"],["slot","icon-only","name","list"],[1,"ion-padding","product-add-content"],[3,"ngSubmit","formGroup"],[1,"styled-input"],["position","floating"],["formControlName","nombre","type","text","required",""],["formControlName","descripcion","type","text","required",""],["formControlName","precio","type","number","required",""],["formControlName","stock","type","number","required",""],["formControlName","categoria","placeholder","Selecciona Categor\xeda","required",""],["value","perro"],["value","gato"],["value","aves"],["lines","none"],["color","primary","expand","full",3,"click"],["slot","start","name","camera"],["class","image-preview",4,"ngIf"],[3,"formGroup",4,"ngFor","ngForOf"],["expand","full","color","secondary",3,"click"],["expand","full","type","submit","color","success",3,"disabled"],["slot","start","name","add-circle"],["expand","full","color","tertiary",3,"click"],["slot","start","name","arrow-back"],[1,"image-preview"],["alt","Imagen del producto",3,"src"],["color","danger","expand","full",3,"click"],["slot","start","name","trash"],[3,"formGroup"],["formControlName","size","type","number","placeholder","Kg","required",""],["formControlName","price","type","number","placeholder","Precio","required",""],["formControlName","stock","type","number","placeholder","Stock","required",""],["color","danger",3,"click"]],template:function(e,r){1&e&&(o.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),o.EFF(3,"Agregar Producto"),o.k0s(),o.j41(4,"ion-buttons",1)(5,"ion-button",2),o.bIt("click",function(){return r.goToProductAll()}),o.nrm(6,"ion-icon",3),o.k0s()()()(),o.j41(7,"ion-content",4)(8,"form",5),o.bIt("ngSubmit",function(){return r.addProduct()}),o.j41(9,"ion-item",6)(10,"ion-label",7),o.EFF(11,"Nombre del Producto"),o.k0s(),o.nrm(12,"ion-input",8),o.k0s(),o.j41(13,"ion-item",6)(14,"ion-label",7),o.EFF(15,"Descripci\xf3n"),o.k0s(),o.nrm(16,"ion-input",9),o.k0s(),o.j41(17,"ion-item",6)(18,"ion-label",7),o.EFF(19,"Precio Base"),o.k0s(),o.nrm(20,"ion-input",10),o.k0s(),o.j41(21,"ion-item",6)(22,"ion-label",7),o.EFF(23,"Stock Inicial"),o.k0s(),o.nrm(24,"ion-input",11),o.k0s(),o.j41(25,"ion-item",6)(26,"ion-label"),o.EFF(27,"Categor\xeda"),o.k0s(),o.j41(28,"ion-select",12)(29,"ion-select-option",13),o.EFF(30,"Perro"),o.k0s(),o.j41(31,"ion-select-option",14),o.EFF(32,"Gato"),o.k0s(),o.j41(33,"ion-select-option",15),o.EFF(34,"Aves"),o.k0s()()(),o.j41(35,"ion-item",16)(36,"ion-label"),o.EFF(37,"Imagen del Producto"),o.k0s(),o.j41(38,"ion-button",17),o.bIt("click",function(){return r.selectImage()}),o.nrm(39,"ion-icon",18),o.EFF(40," Seleccionar Imagen "),o.k0s()(),o.DNE(41,F,5,1,"div",19)(42,b,12,1,"ion-item",20),o.j41(43,"ion-button",21),o.bIt("click",function(){return r.addWeightOption()}),o.EFF(44," Agregar Opci\xf3n de Peso "),o.k0s(),o.j41(45,"ion-button",22),o.nrm(46,"ion-icon",23),o.EFF(47," Agregar Producto "),o.k0s()(),o.j41(48,"ion-button",24),o.bIt("click",function(){return r.goToProductAll()}),o.nrm(49,"ion-icon",25),o.EFF(50," Volver "),o.k0s()()),2&e&&(o.R7$(8),o.Y8G("formGroup",r.productForm),o.R7$(33),o.Y8G("ngIf",r.productImage),o.R7$(),o.Y8G("ngForOf",r.weightOptions.controls),o.R7$(3),o.Y8G("disabled",!r.productForm.valid))},dependencies:[p.Sq,p.bT,i.qT,i.BC,i.cb,i.YS,i.j4,i.JD,n.Jm,n.QW,n.W9,n.eU,n.iq,n.$w,n.uz,n.he,n.Nm,n.Ip,n.BC,n.ai,n.su,n.Je,n.Gw],styles:[".product-form[_ngcontent-%COMP%]{padding:20px;max-width:600px;margin:auto}.form-item[_ngcontent-%COMP%]{margin-bottom:15px}.uploaded-image[_ngcontent-%COMP%]{display:block;margin:15px auto;max-width:100%;border-radius:10px;height:auto}ion-button[_ngcontent-%COMP%]{margin-top:10px;font-weight:700}ion-content[_ngcontent-%COMP%]{padding-bottom:20px}"]}),a})()}];let x=(()=>{var t;class a{}return(t=a).\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[m.iI.forChild(v),m.iI]}),a})();var A=d(1626);let y=(()=>{var t;class a{}return(t=a).\u0275fac=function(e){return new(e||t)},t.\u0275mod=o.$C({type:t}),t.\u0275inj=o.G2t({imports:[p.MD,i.YN,i.X1,n.bv,A.q1,x]}),a})()}}]);