"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[822],{822:(k,g,d)=>{d.r(g),d.d(g,{PerroPageModule:()=>y});var l=d(177),h=d(9417),n=d(4742),u=d(9192),p=d(467),e=d(4438),P=d(636),f=d(224);function m(o,c){if(1&o){const r=e.RV6();e.j41(0,"div",17),e.bIt("click",function(){const i=e.eBV(r).$implicit,a=e.XpG(2).$implicit,s=e.XpG();return e.Njj(s.selectWeight(a,i))}),e.EFF(1),e.k0s()}if(2&o){const r=c.$implicit,t=e.XpG(2).$implicit,i=e.XpG();e.AVh("selected",i.isSelected(t,r)),e.R7$(),e.SpI(" ",r.size," kg ")}}function v(o,c){if(1&o&&(e.j41(0,"div",15),e.DNE(1,m,2,3,"div",16),e.k0s()),2&o){const r=e.XpG().$implicit,t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.weightOptionsMap[r.id])}}function _(o,c){if(1&o&&(e.j41(0,"div")(1,"p",18)(2,"strong"),e.EFF(3,"Precio:"),e.k0s(),e.EFF(4),e.k0s(),e.j41(5,"p",19)(6,"strong"),e.EFF(7,"Stock:"),e.k0s(),e.EFF(8),e.k0s()()),2&o){const r=e.XpG().$implicit;e.R7$(4),e.SpI(" $",r.selectedWeight.price,""),e.R7$(4),e.SpI(" ",r.selectedWeight.stock,"")}}function F(o,c){if(1&o){const r=e.RV6();e.j41(0,"ion-col",8)(1,"ion-card"),e.nrm(2,"ion-img",9),e.j41(3,"ion-card-header")(4,"ion-card-title",10),e.EFF(5),e.k0s()(),e.j41(6,"ion-card-content")(7,"p",11),e.EFF(8),e.k0s(),e.DNE(9,v,2,1,"div",12)(10,_,9,2,"div",13),e.j41(11,"ion-button",14),e.bIt("click",function(){const i=e.eBV(r).$implicit,a=e.XpG();return e.Njj(a.addToCart(i))}),e.EFF(12," Agregar al carrito "),e.k0s()()()()}if(2&o){const r=c.$implicit,t=e.XpG();e.R7$(2),e.Y8G("src",r.imagen||"assets/default-image.jpg"),e.R7$(3),e.JRh(r.nombre),e.R7$(3),e.JRh(r.descripcion),e.R7$(),e.Y8G("ngIf",r.id&&t.weightOptionsMap[r.id]),e.R7$(),e.Y8G("ngIf",r.selectedWeight)}}const O=[{path:"",component:(()=>{var o;class c{constructor(t,i){this.productService=t,this.cartService=i,this.products=[],this.filteredProducts=[],this.weightOptionsMap={},this.selectedCategory=""}ngOnInit(){this.productService.products$.subscribe(t=>{this.products=t,this.filteredProducts=[...this.products],this.loadWeightOptionsForProducts()})}ionViewWillEnter(){this.productService.loadProductsByCategory("perro")}loadWeightOptionsForProducts(){var t=this;return(0,p.A)(function*(){for(const i of t.products)t.weightOptionsMap[i.id||""]=[],yield t.loadWeightOptions(i)})()}loadWeightOptions(t){var i=this;return(0,p.A)(function*(){if(t.id){let s=[];if(yield i.productService.isApiAvailable())try{s=(yield i.productService.getWeightOptionsByProductIdAPI(t.id).toPromise())||[],console.log(`Opciones de peso obtenidas de la API para el producto ${t.id}:`,s)}catch($){console.error("Error al obtener opciones de peso desde la API:",$)}s.length||(s=(yield i.productService.getWeightOptionsByProductIdSQLite(t.id))||[],console.log(`Opciones de peso obtenidas de SQLite para el producto ${t.id}:`,s)),i.weightOptionsMap[t.id]=s||[]}})()}sortProducts(t){const i=t.detail.value;"price-asc"===i?this.filteredProducts.sort((a,s)=>a.precio-s.precio):"price-desc"===i&&this.filteredProducts.sort((a,s)=>s.precio-a.precio)}selectWeight(t,i){t.selectedWeight=i}isSelected(t,i){return t.selectedWeight===i}addToCart(t){var i=this;return(0,p.A)(function*(){if(t.selectedWeight)try{yield i.cartService.addToCart(t,1,t.selectedWeight),console.log("Producto agregado al carrito:",t)}catch(a){console.error("Error al agregar producto al carrito:",a)}else console.log("Selecciona un peso antes de agregar al carrito.")})()}}return(o=c).\u0275fac=function(t){return new(t||o)(e.rXU(P.b),e.rXU(f.m))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-perro"]],decls:15,vars:1,consts:[["color","primary"],[1,"custom-title"],[1,"ion-padding","custom-content"],["size","6"],["placeholder","Ordenar por",3,"ionChange"],["value","price-asc"],["value","price-desc"],["size","12","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","4"],[1,"product-image",3,"src"],[1,"product-title"],[1,"product-description"],["class","weight-options",4,"ngIf"],[4,"ngIf"],["expand","block","fill","outline","color","secondary",1,"add-to-cart-button",3,"click"],[1,"weight-options"],["class","weight-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"weight-item",3,"click"],[1,"selected-price"],[1,"stock-info"]],template:function(t,i){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),e.EFF(3,"Pawsy - Perros"),e.k0s()()(),e.j41(4,"ion-content",2)(5,"ion-row")(6,"ion-col",3)(7,"ion-select",4),e.bIt("ionChange",function(s){return i.sortProducts(s)}),e.j41(8,"ion-select-option",5),e.EFF(9,"Precio: Menor a Mayor"),e.k0s(),e.j41(10,"ion-select-option",6),e.EFF(11,"Precio: Mayor a Menor"),e.k0s()()()(),e.j41(12,"ion-grid")(13,"ion-row"),e.DNE(14,F,13,5,"ion-col",7),e.k0s()()()),2&t&&(e.R7$(14),e.Y8G("ngForOf",i.filteredProducts))},dependencies:[l.Sq,l.bT,n.Jm,n.b_,n.I9,n.ME,n.tN,n.hU,n.W9,n.lO,n.eU,n.KW,n.ln,n.Nm,n.Ip,n.BC,n.ai,n.Je],styles:[".custom-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:700}.product-image[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:8px}.product-title[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;margin-top:8px}.product-description[_ngcontent-%COMP%]{font-size:.9em;color:#666;margin-top:4px}.weight-options[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:10px;justify-content:center}.weight-item[_ngcontent-%COMP%]{background-color:#f0f0f0;border-radius:4px;padding:4px 8px;text-align:center;font-size:.8em;cursor:pointer;transition:background-color .3s ease;min-width:40px}.weight-item.selected[_ngcontent-%COMP%]{background-color:#d1c4e9;color:#000;font-weight:700}.selected-price[_ngcontent-%COMP%]{font-size:1em;color:#555;font-weight:600;margin-top:8px;text-align:center}.add-to-cart-button[_ngcontent-%COMP%]{margin-top:12px;font-weight:700;border-radius:6px}"]}),c})()}];let M=(()=>{var o;class c{}return(o=c).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[u.iI.forChild(O),u.iI]}),c})(),y=(()=>{var o;class c{}return(o=c).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[l.MD,h.YN,n.bv,M]}),c})()}}]);