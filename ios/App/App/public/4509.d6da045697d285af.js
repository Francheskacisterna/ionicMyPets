"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4509],{4509:(k,g,l)=>{l.r(g),l.d(g,{GatoPageModule:()=>y});var d=l(177),h=l(9417),c=l(4742),u=l(9192),p=l(467),t=l(4438),f=l(636),m=l(224);function P(o,r){if(1&o){const n=t.RV6();t.j41(0,"div",17),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG(2).$implicit,s=t.XpG();return t.Njj(s.selectWeight(a,i))}),t.EFF(1),t.k0s()}if(2&o){const n=r.$implicit,e=t.XpG(2).$implicit,i=t.XpG();t.AVh("selected",i.isSelected(e,n)),t.R7$(),t.SpI(" ",n.size," kg ")}}function v(o,r){if(1&o&&(t.j41(0,"div",15),t.DNE(1,P,2,3,"div",16),t.k0s()),2&o){const n=t.XpG().$implicit,e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.weightOptionsMap[n.id])}}function _(o,r){if(1&o&&(t.j41(0,"div")(1,"p",18)(2,"strong"),t.EFF(3,"Precio:"),t.k0s(),t.EFF(4),t.k0s(),t.j41(5,"p",19)(6,"strong"),t.EFF(7,"Stock:"),t.k0s(),t.EFF(8),t.k0s()()),2&o){const n=t.XpG().$implicit;t.R7$(4),t.SpI(" $",n.selectedWeight.price,""),t.R7$(4),t.SpI(" ",n.selectedWeight.stock,"")}}function G(o,r){if(1&o){const n=t.RV6();t.j41(0,"ion-col",8)(1,"ion-card"),t.nrm(2,"ion-img",9),t.j41(3,"ion-card-header")(4,"ion-card-title",10),t.EFF(5),t.k0s()(),t.j41(6,"ion-card-content")(7,"p",11),t.EFF(8),t.k0s(),t.DNE(9,v,2,1,"div",12)(10,_,9,2,"div",13),t.j41(11,"ion-button",14),t.bIt("click",function(){const i=t.eBV(n).$implicit,a=t.XpG();return t.Njj(a.addToCart(i))}),t.EFF(12," Agregar al carrito "),t.k0s()()()()}if(2&o){const n=r.$implicit,e=t.XpG();t.R7$(2),t.Y8G("src",n.imagen||"assets/default-image.jpg"),t.R7$(3),t.JRh(n.nombre),t.R7$(3),t.JRh(n.descripcion),t.R7$(),t.Y8G("ngIf",n.id&&e.weightOptionsMap[n.id]),t.R7$(),t.Y8G("ngIf",n.selectedWeight)}}const F=[{path:"",component:(()=>{var o;class r{constructor(e,i){this.productService=e,this.cartService=i,this.products=[],this.filteredProducts=[],this.weightOptionsMap={},this.selectedCategory=""}ngOnInit(){this.productService.products$.subscribe(e=>{this.products=e,this.filteredProducts=[...this.products],this.loadWeightOptionsForProducts()})}ionViewWillEnter(){this.productService.loadProductsByCategory("gato")}loadWeightOptionsForProducts(){var e=this;return(0,p.A)(function*(){for(const i of e.products)e.weightOptionsMap[i.id||""]=[],yield e.loadWeightOptions(i)})()}loadWeightOptions(e){var i=this;return(0,p.A)(function*(){if(e.id){let s=[];if(yield i.productService.isApiAvailable())try{s=(yield i.productService.getWeightOptionsByProductIdAPI(e.id).toPromise())||[],console.log(`Opciones de peso obtenidas de la API para el producto ${e.id}:`,s)}catch(M){console.error("Error al obtener opciones de peso desde la API:",M)}s.length||(s=(yield i.productService.getWeightOptionsByProductIdSQLite(e.id))||[],console.log(`Opciones de peso obtenidas de SQLite para el producto ${e.id}:`,s)),i.weightOptionsMap[e.id]=s||[]}})()}sortProducts(e){const i=e.detail.value;"price-asc"===i?this.filteredProducts.sort((a,s)=>a.precio-s.precio):"price-desc"===i&&this.filteredProducts.sort((a,s)=>s.precio-a.precio)}selectWeight(e,i){e.selectedWeight=i}isSelected(e,i){return e.selectedWeight===i}addToCart(e){var i=this;return(0,p.A)(function*(){if(e.selectedWeight)try{yield i.cartService.addToCart(e,1,e.selectedWeight),(yield i.productService.isApiAvailable())?yield i.productService.updateWeightOptionAPI(e.selectedWeight).toPromise():yield i.productService.updateWeightOptionSQLite(e.selectedWeight),console.log("Producto agregado al carrito y stock actualizado:",e)}catch(a){console.error("Error al agregar producto al carrito:",a)}else console.log("Selecciona un peso antes de agregar al carrito.")})()}}return(o=r).\u0275fac=function(e){return new(e||o)(t.rXU(f.b),t.rXU(m.m))},o.\u0275cmp=t.VBU({type:o,selectors:[["app-gato"]],decls:15,vars:1,consts:[["color","primary"],[1,"custom-title"],[1,"ion-padding","custom-content"],["size","6"],["placeholder","Ordenar por",3,"ionChange"],["value","price-asc"],["value","price-desc"],["size","12","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["size","12","size-md","6","size-lg","4"],[1,"product-image",3,"src"],[1,"product-title"],[1,"product-description"],["class","weight-options",4,"ngIf"],[4,"ngIf"],["expand","block","fill","outline","color","secondary",1,"add-to-cart-button",3,"click"],[1,"weight-options"],["class","weight-item",3,"selected","click",4,"ngFor","ngForOf"],[1,"weight-item",3,"click"],[1,"selected-price"],[1,"stock-info"]],template:function(e,i){1&e&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title",1),t.EFF(3,"Pawsy - Aves"),t.k0s()()(),t.j41(4,"ion-content",2)(5,"ion-row")(6,"ion-col",3)(7,"ion-select",4),t.bIt("ionChange",function(s){return i.sortProducts(s)}),t.j41(8,"ion-select-option",5),t.EFF(9,"Precio: Menor a Mayor"),t.k0s(),t.j41(10,"ion-select-option",6),t.EFF(11,"Precio: Mayor a Menor"),t.k0s()()()(),t.j41(12,"ion-grid")(13,"ion-row"),t.DNE(14,G,13,5,"ion-col",7),t.k0s()()()),2&e&&(t.R7$(14),t.Y8G("ngForOf",i.filteredProducts))},dependencies:[d.Sq,d.bT,c.Jm,c.b_,c.I9,c.ME,c.tN,c.hU,c.W9,c.lO,c.eU,c.KW,c.ln,c.Nm,c.Ip,c.BC,c.ai,c.Je],styles:['@charset "UTF-8";.custom-title[_ngcontent-%COMP%]{font-size:1.2em;font-weight:700}.product-image[_ngcontent-%COMP%]{width:100%;height:auto;border-radius:8px}.product-title[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;margin-top:8px}.product-description[_ngcontent-%COMP%]{font-size:.9em;color:#666;margin-top:4px}.weight-options[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:10px;justify-content:center}.weight-item[_ngcontent-%COMP%]{background-color:#f0f0f0;border-radius:4px;padding:4px 8px;text-align:center;font-size:.8em;cursor:pointer;transition:background-color .3s ease;min-width:40px}.weight-item.selected[_ngcontent-%COMP%]{background-color:#d1c4e9;color:#000;font-weight:700}.selected-price[_ngcontent-%COMP%]{font-size:1em;color:#555;font-weight:600;margin-top:8px;text-align:center}.add-to-cart-button[_ngcontent-%COMP%]{margin-top:12px;font-weight:700;border-radius:6px}']}),r})()}];let O=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[u.iI.forChild(F),u.iI]}),r})(),y=(()=>{var o;class r{}return(o=r).\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.$C({type:o}),o.\u0275inj=t.G2t({imports:[d.MD,h.YN,c.bv,O]}),r})()}}]);